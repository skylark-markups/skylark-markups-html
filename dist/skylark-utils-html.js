/**
 * skylark-utils-html - The html features enhancement for skylark utils.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
!function(e,t){function n(e,t){if("."!==e[0])return e;var n=t.split("/"),r=e.split("/");n.pop();for(var i=0;i<r.length;i++)"."!=r[i]&&(".."==r[i]?n.pop():n.push(r[i]));return n.join("/")}var r=t.define,i=t.require,s="function"==typeof r&&r.amd,a=!s&&"undefined"!=typeof exports;if(!s&&!r){var o={};r=t.define=function(e,t,r){"function"==typeof r?(o[e]={factory:r,deps:t.map(function(t){return n(t,e)}),exports:null},i(e)):o[e]=r},i=t.require=function(e){if(!o.hasOwnProperty(e))throw new Error("Module "+e+" has not been defined");var t=o[e];if(!t.exports){var n=[];t.deps.forEach(function(e){n.push(i(e))}),t.exports=t.factory.apply(window,n)}return t.exports}}if(!r)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(e(r,i),!s){var l=i("skylark-utils-interact/main");a?exports=l:t.skylarkjs=l}}(function(e,t){e("skylark-utils/skylark",["skylark-langx/skylark"],function(e){return e}),e("skylark-utils-html/html",["skylark-utils/skylark"],function(e){return e.html=e.html||{}}),e("skylark-utils/langx",["skylark-langx/langx"],function(e){return e}),e("skylark-utils/browser",["./skylark","./langx"],function(e,t){function n(e){return c?c+e:e.toLowerCase()}function r(e){return h[e]||e}function i(e){return _[e]||e}function s(){return s}var a,o,l="",u="",c="",_={},h={},f=/^(Webkit|webkit|O|Moz|moz|ms)(.*)$/,p=window.document,d=p.createElement("div"),m=d.webkitMatchesSelector||d.mozMatchesSelector||d.oMatchesSelector||d.matchesSelector,g=d.requestFullscreen||d.webkitRequestFullscreen||d.mozRequestFullScreen||d.msRequestFullscreen,v=(p.exitFullscreen||p.webkitCancelFullScreen||p.mozCancelFullScreen||p.msExitFullscreen,d.style);for(var y in v){var E=y.match(o||f);if(E){o||(a=E[1],o=new RegExp("^("+a+")(.*)$"),u=a,l="-"+a.toLowerCase()+"-",c=a.toLowerCase()),_[t.lowerFirst(E[2])]=y;var T=t.dasherize(E[2]);h[T]=l+T}}return t.mixin(s,{css3PropPrefix:l,normalizeStyleProperty:i,normalizeCssProperty:r,normalizeCssEvent:n,matchesSelector:m,requestFullScreen:g,exitFullscreen:g,location:function(){return window.location},support:{}}),d=null,e.browser=s}),e("skylark-utils/styler",["./skylark","./langx"],function(e,t){function n(e,t){return"number"!=typeof t||g[m(e)]?t:t+"px"}function r(e){return e in v?v[e]:v[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function i(e,t){var n=e.className||"",r=n&&void 0!==n.baseVal;return void 0===t?r?n.baseVal:n:void(r?n.baseVal=t:e.className=t)}function s(e){var t,n;return y[e]||(t=document.createElement(e),document.body.appendChild(t),n=getComputedStyle(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),"none"==n&&(n="block"),y[e]=n),y[e]}function a(e){return E.css(e,"display",""),"none"==E.css(e,"display")&&E.css(e,"display",s(e.nodeName)),this}function o(e){return"none"==E.css(e,"display")||0==E.css(e,"opacity")}function l(e){return E.css(e,"display","none"),this}function u(e,n){if(!n)return this;var s,a=i(e);return s=t.isString(n)?n.split(/\s+/g):n,s.forEach(function(e){var t=r(e);a.match(t)||(a+=(a?" ":"")+e)}),i(e,a),this}function c(e,r,i){if(arguments.length<3){var s,s=getComputedStyle(e,"");if(t.isString(r))return e.style[d(r)]||s.getPropertyValue(r);if(t.isArrayLike(r)){var a={};return p.call(r,function(t){a[t]=e.style[d(t)]||s.getPropertyValue(t)}),a}}var o="";if("string"==typeof r)i||0===i?o=m(r)+":"+n(r,i):e.style.removeProperty(m(r));else for(key in r)void 0!==r[key]&&(r[key]||0===r[key]?o+=m(key)+":"+n(key,r[key])+";":e.style.removeProperty(m(key)));return e.style.cssText+=";"+o,this}function _(e,t){var n=r(t);return e.className&&e.className.match(n)}function h(e,n){if(n){var s,a=i(e);s=t.isString(n)?n.split(/\s+/g):n,s.forEach(function(e){var t=r(e);a.match(t)&&(a=a.replace(t," "))}),i(e,a.trim())}else i(e,"");return this}function f(e,t,n){var r=this;return t.split(/\s+/g).forEach(function(t){void 0===n&&(n=!r.hasClass(e,t)),n?r.addClass(e,t):r.removeClass(e,t)}),r}var p=(Array.prototype.every,Array.prototype.forEach),d=t.camelCase,m=t.dasherize,g={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},v={},y={},E=function(){return E};return t.mixin(E,{autocssfix:!1,cssHooks:{},addClass:u,className:i,css:c,hasClass:_,hide:l,isInvisible:o,removeClass:h,show:a,toggleClass:f}),e.styler=E}),e("skylark-utils/noder",["./skylark","./langx","./browser","./styler"],function(e,t,n,r){function i(e,n){return t.isArrayLike(e)||(e=[e]),n&&(e=z.call(e,function(e){return e.cloneNode(!0)})),t.flatten(e)}function s(e,t){var n=e.nodeName&&e.nodeName.toLowerCase();return void 0!==t?n===t.toLowerCase():n}function a(e,t,n){var r=e,s=r.parentNode;if(s)for(var a=i(t,n),r=r.nextSibling,o=0;o<a.length;o++)r?s.insertBefore(a[o],r):s.appendChild(a[o]);return this}function o(e,t,n){for(var r=e,s=i(t,n),a=0;a<s.length;a++)r.appendChild(s[a]);return this}function l(e,t,n){var r=e,s=r.parentNode;if(s)for(var a=i(t,n),o=0;o<a.length;o++)s.insertBefore(a[o],r);return this}function u(e){return s(e,"iframe")?e.contentDocument:e.childNodes}function c(e,t,n){var r=document.createElement(e);if(t)for(var i in t)r.setAttribute(i,t[i]);return n&&o(n,r),r}function _(e){if(e=t.trim(e),V.test(e))return[c(RegExp.$1)];var n=I.test(e)&&RegExp.$1;n in U||(n="*");var r=U[n];return r.innerHTML=""+e,dom=$.call(r.childNodes),dom.forEach(function(e){r.removeChild(e)}),dom}function h(e,t){var n,r=this;return!P||1!==e.nodeType||t?e.cloneNode(t):t?void 0:(n=document.createElement(e.nodeName),each(r.getAttribs(e),function(t){r.setAttrib(n,t.nodeName,r.getAttrib(e,t.nodeName))}),n)}function f(e,t){return y(t,e)}function p(e){return document.createTextNode(e)}function d(){return document}function m(e){for(;e.hasChildNodes();){var t=e.firstChild;e.removeChild(t)}return this}function g(e){if(e===!1)n.exitFullScreen.apply(document);else{if(!e)return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;n.requestFullScreen.apply(e),G=e}}function v(e,n){if(void 0===n)return e.innerHTML;if(this.empty(e),n=n||"",t.isString(n)||t.isNumber(n))e.innerHTML=n;else if(t.isArrayLike(n))for(var r=0;r<n.length;r++)e.appendChild(n[r]);else e.appendChild(n)}function y(e,t,n){if(n)return e.parentNode===t;if(document.documentElement.contains)return t.contains(e);for(;e;){if(t===e)return!0;e=e.parentNode}return!1}function E(e){return null!=e&&e.nodeType==e.DOCUMENT_NODE}function T(e){return e?9==e.nodeType?e:e.ownerDocument:document}function b(e){var t=T(e);return t.defaultView||t.parentWindow}function k(e,t,n){for(var r=e,s=r.firstChild,a=i(t,n),o=0;o<a.length;o++)s?r.insertBefore(a[o],s):r.appendChild(a[o]);return this}function x(e){for(var t=e.offsetParent||document.body;t&&!W.test(t.nodeName)&&"static"==r.css(t,"position");)t=t.offsetParent;return t}function w(e,t){var n=c("div",t);return r.css(n,{position:"absolute",top:0,left:0,width:"100%",height:"100%",zIndex:2147483647,opacity:.7}),e.appendChild(n),n}function S(e){if(e&&e.parentNode)try{e.parentNode.removeChild(e)}catch(t){console.warn("The node is already removed",t)}return this}function R(e,t){return t.parentNode.replaceChild(e,t),this}function K(e,t){t=t||{};var n,r=this,i=t.text,s=t.style,a=t.time,o=t.callback,l=this.createElement("div",{className:t.className||"throbber",style:s}),u=(w(l,{className:"overlay fade"}),this.createElement("div",{className:"throb"})),c=this.createTextNode(i||""),_=function(){n&&(clearTimeout(n),n=null),l&&(r.remove(l),l=null)},h=function(e){e&&e.text&&l&&(c.nodeValue=e.text)};u.appendChild(c),l.appendChild(u),e.appendChild(l);var f=function(){_(),o&&o()};return a&&(n=setTimeout(f,a)),{remove:_,update:h}}function A(e,t){t(e);for(var n=0,r=e.childNodes.length;n<r;n++)A(e.childNodes[n],t);return this}function C(e){for(var t=e.firstChild,n=e.children.length-1;n>0;n--)if(n>0){var r=e.children[n];e.insertBefore(r,t)}}function N(e,n){t.isString(n)&&(n=this.createFragment(n).firstChild),e.parentNode.insertBefore(n,e),n.appendChild(e)}function O(e,t){var n=$.call(e.childNodes);e.appendChild(t);for(var r=0;r<n.length;r++)t.appendChild(n[r]);return this}function L(e){var t=e.parentNode;if(t){if(this.isDoc(t.parentNode))return;t.parentNode.insertBefore(e,t)}}function D(){return D}var P=!!navigator.userAgent.match(/Trident/g)||!!navigator.userAgent.match(/MSIE/g),I=/^\s*<(\w+|!)[^>]*>/,V=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,j=document.createElement("div"),M=document.createElement("table"),F=document.createElement("tbody"),B=document.createElement("tr"),U={tr:F,tbody:M,thead:M,tfoot:M,td:B,th:B,"*":j},W=/^(?:body|html)$/i,z=Array.prototype.map,$=Array.prototype.slice,G=null;return t.mixin(D,{body:function(){return document.body},clone:h,contents:u,createElement:c,createFragment:_,contains:f,createTextNode:p,doc:d,empty:m,fullScreen:g,html:v,isChildOf:y,isDoc:E,isWindow:t.isWindow,offsetParent:x,ownerDoc:T,ownerWindow:b,after:a,before:l,prepend:k,append:o,remove:S,replace:R,throb:K,traverse:A,reverse:C,wrapper:N,wrapperInner:O,unwrap:L}),e.noder=D}),e("skylark-utils/css",["./skylark","./langx","./noder"],function(e,t,n){function r(e,r){var i,s={type:"text/css"},a=g++;return r=r||{},r.media&&(s.media=r.media),i=e?n.create("link",t.mixin(s,{rel:"stylesheet",async:!1})):n.createElement("style",s),n.append(m,i),v[a]={id:a,node:i},a}function i(e,t){t||(t={});var n=r(!1,t);return e&&_(n,e),n}function s(e,n){var r=v[e];return t.isNumber(n)?b.call(r,n):t.each(r[T],function(e,t){if(n===t)return b.call(r,e),!1}),this}function a(e){return s(y,e),this}function o(e){if(e===y)throw new Error("The default stylesheet can not be deleted");var t=v[e];return delete v[e],n.remove(t.node),this}function l(e,t,n){return this.insertSheetRule(y,e,t,n)}function u(e){return this.addRules(y,e)}function c(e,t,n,r){if(!t||!n)return-1;var i=v[e];return r=r||i[T].length,d.call(i,t,n,r)}function _(e,r){var i,s=v[e];return i=t.isString(r)?r:f(r),n.append(s.node,n.createTextNode(i)),this}function h(e){return e.startsWith("@")}function f(e){var n=function(e,t,n){return e&&(h(e)?n+=1:t=e+" "+t),{name:t,depth:n}},r=function(e,i,s){var a="",o=h(e);if(h(e))t.isString(i)?a=p.SPACE.repeat(s)+e.trim()+' "'+i.trim()+' ";\n':(a+=p.SPACE.repeat(s)+e.trim()+" {\n",a+=r("",i,s+1),a+=p.SPACE.repeat(s)+" }\n");else if(t.isString(i))a=p.SPACE.repeat(s)+e.trim(),a=o?a+' "'+i.trim()+' ";\n':a+": "+i.trim()+";\n";else if(t.isArray(i))for(var l=0;l<i.length;l++)a+=r(e,i[l],s);else{if(e){a+=p.SPACE.repeat(s)+e.trim()+" {\n";for(var l in i){var u=i[l];t.isString(u)&&(a+=r(l,u,s+1))}a+=p.SPACE.repeat(s)+"}\n"}for(var l in i){var u=i[l];if(!t.isString(u)){var c=n(e,l,s);a+=r(c.name,u,c.depth)}}}return a};return r("",e,0)}function p(){return p}var d,m=document.getElementsByTagName("head")[0],g=0,v={},y=r(),E=v[y],T="cssRules"in E?"cssRules":"rules",b=E.deleteRule||E.removeRule;if(E.insertRule){var k=E.insertRule;d=function(e,t,n){k.call(this,e+"{"+t+"}",n)}}else d=E.addRule;return t.mixin(p,{SPACE:"\t",addRules:u,addSheetRules:_,createStyleSheet:i,deleteSheetRule:s,deleteRule:a,insertRule:l,insertSheetRule:c,removeStyleSheet:o,toString:f}),e.css=p}),e("skylark-utils-css/css",["skylark-utils/skylark","skylark-utils/css"],function(e,t){return t}),e("skylark-utils-css/primitives/beautify-css",[],function(){function e(t,n){function r(){return v=t.charAt(++E),v||""}function i(e){var n=E;return e&&o(),result=t.charAt(E+1)||"",E=n-1,r(),result}function s(e){for(var n=E;r();)if("\\"===v)r();else{if(e.indexOf(v)!==-1)break;if("\n"===v)break}return t.substring(n,E+1)}function a(e){var t=E,n=s(e);return E=t-1,r(),n}function o(){for(var e="";y.test(i());)r(),e+=v;return e}function l(){var e="";for(v&&y.test(v)&&(e=v);y.test(r());)e+=v;return e}function u(e){var n=E,e="/"===i();for(r();r();){if(!e&&"*"===v&&"/"===i()){r();break}if(e&&"\n"===v)return t.substring(n,E)}return t.substring(n,E)+v}function c(e){return t.substring(E-e.length,E).toLowerCase()===e}function _(){for(var e=E+1;e<t.length;e++){var n=t.charAt(e);if("{"===n)return!0;if(";"===n||"}"===n||")"===n)return!1}return!1}function h(){k++,T+=b}function f(){k--,T=T.slice(0,-p)}n=n||{};var p=n.indent_size||4,d=n.indent_char||" ",m=void 0===n.selector_separator_newline||n.selector_separator_newline,g=void 0!==n.end_with_newline&&n.end_with_newline;"string"==typeof p&&(p=parseInt(p,10));var v,y=/^\s+$/,E=-1,T=t.match(/^[\t ]*/)[0],b=new Array(p+1).join(d),k=0,x=0,w={};w["{"]=function(e){w.singleSpace(),S.push(e),w.newLine()},w["}"]=function(e){w.newLine(),S.push(e),w.newLine()},w._lastCharWhitespace=function(){return y.test(S[S.length-1])},w.newLine=function(e){e||w.trim(),S.length&&S.push("\n"),T&&S.push(T)},w.singleSpace=function(){S.length&&!w._lastCharWhitespace()&&S.push(" ")},w.trim=function(){for(;w._lastCharWhitespace();)S.pop()};var S=[];T&&S.push(T);for(var R=!1,K=!1,A="",C="";;){var N=l(),O=""!==N,L=N.indexOf("\n")!==-1,C=A,A=v;if(!v)break;if("/"===v&&"*"===i()){var D=c("");w.newLine(),S.push(u()),w.newLine(),D&&w.newLine(!0)}else if("/"===v&&"/"===i())L||"{"===C||w.trim(),w.singleSpace(),S.push(u()),w.newLine();else if("@"===v){O&&w.singleSpace(),S.push(v);var P=a(": ,;{}()[]/='\"").replace(/\s$/,"");P in e.NESTED_AT_RULE?(x+=1,P in e.CONDITIONAL_GROUP_RULE&&(K=!0)):": ".indexOf(P[P.length-1])>=0&&(r(),P=s(": ").replace(/\s$/,""),S.push(P),w.singleSpace())}else"{"===v?"}"===i(!0)?(o(),r(),w.singleSpace(),S.push("{}")):(h(),w["{"](v),K?(K=!1,R=k>x):R=k>=x):"}"===v?(f(),w["}"](v),R=!1,x&&x--):":"===v?(o(),!R&&!K||c("&")||_()?":"===i()?(r(),S.push("::")):S.push(":"):(S.push(":"),w.singleSpace())):'"'===v||"'"===v?(O&&w.singleSpace(),S.push(s(v))):";"===v?(S.push(v),w.newLine()):"("===v?c("url")?(S.push(v),o(),r()&&(")"!==v&&'"'!==v&&"'"!==v?S.push(s(")")):E--)):(O&&w.singleSpace(),S.push(v),o()):")"===v?S.push(v):","===v?(S.push(v),o(),!R&&m?w.newLine():w.singleSpace()):"]"===v?S.push(v):"["===v?(O&&w.singleSpace(),S.push(v)):"="===v?(o(),S.push(v)):(O&&w.singleSpace(),S.push(v))}var I=S.join("").replace(/[\r\n\t ]+$/,"");return g&&(I+="\n"),I}return e.NESTED_AT_RULE={"@page":!0,"@font-face":!0,"@keyframes":!0,"@media":!0,"@supports":!0,"@document":!0},e.CONDITIONAL_GROUP_RULE={"@media":!0,"@supports":!0,"@document":!0},{css_beautify:e}}),e("skylark-utils-css/beautify",["./css","./primitives/beautify-css"],function(e,t){return e.beautify=t.css_beautify}),e("skylark-utils/finder",["./skylark","./langx","./browser","./noder"],function(e,t,n,r,s){function a(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function o(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function l(e,n,r){for(var i=r&&t.isString(r);e=e.parentNode;){if(y(e,n))return e;if(r)if(i){if(y(e,r))break}else if(e==r)break}return null}function u(e,n,r){for(var i=[],s=r&&t.isString(r);(e=e.parentNode)&&9!==e.nodeType;)if(i.push(e),r)if(s){if(y(e,r))break}else if(e==r)break;return n&&(i=S.filter(i,n)),i}function c(e,t){return t=t||r.doc(),t.getElementById(e)}function _(e,t){for(var n=e.childNodes,r=[],i=0;i<n.length;i++){var e=n[i];1==e.nodeType&&r.push(e)}return t&&(r=S.filter(r,t)),r}function h(e,t){for(;e&&!y(e,t);)e=e.parentNode;return e}function f(e,t){try{return K.call(e.querySelectorAll(t))}catch(n){}return S.query(e,t)}function p(e,t){try{return e.querySelector(t)}catch(n){}var r=S.query(e,t);return r.length>0?r[0]:null}function d(e,t){return t||(t=e,e=document.body),y(e,t)?e:p(e,t)}function m(e,t){return t||(t=e,e=document.body),f(e,t)}function g(e,t,n){for(var r=e.childNodes,i=r[0];i;){if(1==i.nodeType){if(!t||y(i,t))return i;if(n)break}i=i.nextSibling}return null}function v(e,t,n){for(var r=e.childNodes,i=r[r.length-1];i;){if(1==i.nodeType){if(!t||y(i,t))return i;if(n)break}i=i.previousSibling}return null}function y(e,n){if(!n||!e||1!==e.nodeType)return!1;if(t.isString(n)){try{return A.call(e,n.replace(/\[([^=]+)=\s*([^'"\]]+?)\s*\]/g,'[$1="$2"]'))}catch(r){}return S.match(e,n)}return t.isArrayLike(n)?t.inArray(e,n)>-1:t.isPlainObject(n)?S.check(e,n):e===n}function E(e,t,n){for(var r=e.nextSibling;r;){if(1==r.nodeType){if(!t||y(r,t))return r;if(n)break}r=r.nextSibling}return null}function T(e,t){for(var n=e.nextSibling,r=[];n;)1==n.nodeType&&(t&&!y(n,t)||r.push(n)),n=n.nextSibling;return r}function b(e,t){var n=e.parentNode;return!n||t&&!y(n,t)?null:n}function k(e,t,n){for(var r=e.previousSibling;r;){if(1==r.nodeType){if(!t||y(r,t))return r;if(n)break}r=r.previousSibling}return null}function x(e,t){for(var n=e.previousSibling,r=[];n;)1==n.nodeType&&(t&&!y(n,t)||r.push(n)),n=n.previousSibling;return r}function w(e,t){for(var n=e.parentNode.firstChild,r=[];n;)1==n.nodeType&&n!==e&&(t&&!y(n,t)||r.push(n)),n=n.nextSibling;return r}var S={},R=Array.prototype.filter,K=Array.prototype.slice,A=n.matchesSelector;(function(){function e(e,s,a,l,c,h,f,p,d,m,g,v,y,E,T,b){if((s||n===-1)&&(t.expressions[++n]=[],r=-1,s))return"";if(a||l||r===-1){a=a||" ";var k=t.expressions[n];i&&k[r]&&(k[r].reverseCombinator=u(a)),k[++r]={combinator:a,tag:"*"}}var x=t.expressions[n][r];if(c)x.tag=c.replace(o,"");else if(h)x.id=h.replace(o,"");else if(f)f=f.replace(o,""),x.classList||(x.classList=[]),x.classes||(x.classes=[]),x.classList.push(f),x.classes.push({value:f,regexp:new RegExp("(^|\\s)"+_(f)+"(\\s|$)")});else if(y)b=b||T,b=b?b.replace(o,""):null,x.pseudos||(x.pseudos=[]),x.pseudos.push({key:y.replace(o,""),value:b,type:1==v.length?"class":"element"});else if(p){p=p.replace(o,""),g=(g||"").replace(o,"");var w,S;switch(d){case"^=":S=new RegExp("^"+_(g));break;case"$=":S=new RegExp(_(g)+"$");break;case"~=":S=new RegExp("(^|\\s)"+_(g)+"(\\s|$)");break;case"|=":S=new RegExp("^"+_(g)+"(-|$)");break;case"=":w=function(e){return g==e};break;case"*=":w=function(e){return e&&e.indexOf(g)>-1};break;case"!=":w=function(e){return g!=e};break;default:w=function(e){return!!e}}""==g&&/^[*$^]=$/.test(d)&&(w=function(){return!1}),w||(w=function(e){return e&&S.test(e)}),x.attributes||(x.attributes=[]),x.attributes.push({key:p,operator:d,value:g,test:w})}return""}var t,n,r,i,s={},a={},o=/\\/g,l=function(r,o){if(null==r)return null;if(r.Slick===!0)return r;r=(""+r).replace(/^\s+|\s+$/g,""),i=!!o;var u=i?a:s;if(u[r])return u[r];for(t={Slick:!0,expressions:[],raw:r,reverse:function(){return l(this.raw,!0)}},n=-1;r!=(r=r.replace(h,e)););return t.length=t.expressions.length,u[t.raw]=i?c(t):t},u=function(e){return"!"===e?" ":" "===e?"!":/^!/.test(e)?e.replace(/^!/,""):"!"+e},c=function(e){for(var t=e.expressions,n=0;n<t.length;n++){for(var r=t[n],i={parts:[],tag:"*",combinator:u(r[0].combinator)},s=0;s<r.length;s++){var a=r[s];a.reverseCombinator||(a.reverseCombinator=" "),a.combinator=a.reverseCombinator,delete a.reverseCombinator}r.reverse().push(i)}return e},_=function(){var e=/(?=[\-\[\]{}()*+?.\\\^$|,#\s])/g,t="\\";return function(n){return n.replace(e,t)}}(),h=new RegExp("^(?:\\s*(,)\\s*|\\s*(<combinator>+)\\s*|(\\s+)|(<unicode>+|\\*)|\\#(<unicode>+)|\\.(<unicode>+)|\\[\\s*(<unicode1>+)(?:\\s*([*^$!~|]?=)(?:\\s*(?:([\"']?)(.*?)\\9)))?\\s*\\](?!\\])|(:+)(<unicode>+)(?:\\((?:(?:([\"'])([^\\13]*)\\13)|((?:\\([^)]+\\)|[^()]*)+))\\))?)".replace(/<combinator>/,"["+_(">+~`!@$%^&={}\\;</")+"]").replace(/<unicode>/g,"(?:[\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])").replace(/<unicode1>/g,"(?:[:\\w\\u00a1-\\uFFFF-]|\\\\[^\\s0-9a-f])")),f=this.Slick||{};f.parse=function(e){return l(e)},f.escapeRegExp=_,this.Slick||(this.Slick=f)}).apply(S);var C=/^(?:input|select|textarea|button)$/i,N=/^h\d$/i,K=Array.prototype.slice;S.parseSelector=S.Slick.parse;var O=S.pseudos={button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},checked:function(e){return!!e.checked},contains:function(e,t,n,r){if($(this).text().indexOf(r)>-1)return this},disabled:function(e){return!!e.disabled},enabled:function(e){return!e.disabled},eq:function(e,t,n,r){return t==r},even:function(e,t,n,r){return t%2===0},focus:function(e){return document.activeElement===e&&(e.href||e.type||e.tabindex)},first:function(e,t){return 0===t},gt:function(e,t,n,r){return t>r},has:function(e,t,n,r){return d(e,r)},header:function(e){return N.test(e.nodeName)},hidden:function(e){return!S.pseudos.visible(e)},input:function(e){return C.test(e.nodeName)},last:function(e,t,n){return t===n.length-1},lt:function(e,t,n,r){return t<r},not:function(e,t,n,r){return!y(e,r)},odd:function(e,t,n,r){return t%2===1},parent:function(e){return!!e.parentNode},selected:function(e){return!!e.selected},text:function(e){return"text"===e.type},visible:function(e){return e.offsetWidth&&e.offsetWidth}};["first","eq","last"].forEach(function(e){O[e].isArrayFilter=!0}),O.nth=O.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})O[i]=a(i);for(i in{submit:!0,reset:!0})O[i]=o(i);S.divide=function(e){var t,n,r,i,s,a="",o=[];if((n=e.id)&&(a+="#"+n),r=e.classes)for(var l=r.length;l--;)a+="."+r[l].value;if(i=e.attributes)for(var l=0;l<i.length;l++)a+=i[l].operator?"["+i[l].key+i[l].operator+JSON.stringify(i[l].value)+"]":"["+i[l].key+"]";if(s=e.pseudos)for(l=s.length;l--;)part=s[l],this.pseudos[part.key]?o.push(part):void 0!==part.value&&(a+=":"+part.key+"("+JSON.stringify(part));return(t=e.tag)&&"*"!==t&&(a=t.toUpperCase()+a),a||(a="*"),{nativeSelector:a,customPseudos:o}},S.check=function(e,t,n,r,i){var s,a,o,l,u,c,_,h,f;if(!i){if(s=t.tag){var p=e.nodeName.toUpperCase();if("*"==s){if(p<"@")return!1}else if(p!=(s||"").toUpperCase())return!1}if((a=t.id)&&e.getAttribute("id")!=a)return!1;if(o=t.classes)for(c=o.length;c--;)if(h=e.getAttribute("class"),!h||!o[c].regexp.test(h))return!1;if(l=t.attributes)for(c=l.length;c--;)if(_=l[c],_.operator?!_.test(e.getAttribute(_.key)):!e.hasAttribute(_.key))return!1}if(u=t.pseudos)for(c=u.length;c--;)if(_=u[c],f=this.pseudos[_.key]){if((i&&f.isArrayFilter||!i&&!f.isArrayFilter)&&!f(e,n,r,_.value))return!1}else if(!i&&!A.call(e,_.key))return!1;return!0},S.match=function(e,n){var r;if(r=t.isString(n)?S.Slick.parse(n):n,!r)return!0;var i,s,a=r.expressions,o=0;for(i=0;s=a[i];i++)if(1==s.length){var l=s[0];if(this.check(e,l))return!0;o++}if(o==r.length)return!1;var u,c=this.query(document,r);for(i=0;u=c[i++];)if(u===e)return!0;return!1},S.filterSingle=function(e,t){var n=R.call(e,function(n,r){return S.check(n,t,r,e,!1)});return n=R.call(n,function(e,r){return S.check(e,t,r,n,!0)})},S.filter=function(e,n){var r;if(!t.isString(n))return S.filterSingle(e,n);r=S.Slick.parse(n);var i,s,a=r.expressions,o=[];for(i=0;s=a[i];i++){if(1!=s.length)throw new Error("not supported selector:"+n);var l=s[0],u=S.filterSingle(e,l);o=t.uniq(o.concat(u))}return o},S.combine=function(e,t){var n,r=t.combinator,i=t,s=[];switch(r){case">":s=_(e,i);break;case"+":n=E(e,i,!0),n&&s.push(n);break;case"^":n=g(e,i,!0),n&&s.push(n);break;case"~":s=T(e,i);break;case"++":var a=k(e,i,!0),o=E(e,i,!0);a&&s.push(a),o&&s.push(o);break;case"~~":s=w(e,i);break;case"!":s=u(e,i);break;case"!>":n=b(e,i),n&&s.push(n);break;case"!+":s=k(e,i,!0);break;case"!^":n=v(e,i,!0),n&&s.push(n);break;case"!~":s=x(e,i);break;default:var l=this.divide(t);if(s=K.call(e.querySelectorAll(l.nativeSelector)),l.customPseudos)for(var c=l.customPseudos.length-1;c>=0;c--)s=R.call(s,function(e,t){return S.check(e,{pseudos:[l.customPseudos[c]]},t,s,!1)}),s=R.call(s,function(e,t){return S.check(e,{pseudos:[l.customPseudos[c]]},t,s,!0)})}return s},S.query=function(e,n,r){for(var i,s,a=this.Slick.parse(n),o=[],l=a.expressions,u=0;i=l[u];u++){for(var c,_=[e],h=0;s=i[h];h++)c=t.map(_,function(e,t){return S.combine(e,s)}),c&&(_=c);c&&(o=o.concat(c))}return o};var L=function(){return L};return t.mixin(L,{ancestor:l,ancestors:u,byId:c,children:_,closest:h,descendant:p,descendants:f,find:d,findAll:m,firstChild:g,lastChild:v,matches:y,nextSibling:E,nextSiblings:T,parent:b,previousSibling:k,previousSiblings:x,pseudos:S.pseudos,siblings:w}),e.finder=L}),e("skylark-utils/scripter",["./skylark","./langx","./noder","./finder"],function(e,t,n,r){function i(){return i}var s=document.getElementsByTagName("head")[0],a={},o={},l=0;return t.mixin(i,{loadJavaScript:function(e,t,n){var r=a[e];if(r||(r=a[e]={state:0,loadedCallbacks:[],errorCallbacks:[]}),r.loadedCallbacks.push(t),r.errorCallbacks.push(n),1===r.state)r.node.onload();else if(r.state===-1)r.node.onerror();else{var i=r.node=document.createElement("script"),u=r.id=l++;i.type="text/javascript",i.async=!1,i.defer=!1,startTime=(new Date).getTime(),s.appendChild(i),i.onload=function(){r.state=1;for(var e=r.loadedCallbacks,t=e.length;t--;)e[t]();r.loadedCallbacks=[],r.errorCallbacks=[]},i.onerror=function(){r.state=-1;for(var e=r.errorCallbacks,t=e.length;t--;)e[t]();r.loadedCallbacks=[],r.errorCallbacks=[]},i.src=e,o[u]=i}return r.id},deleteJavaScript:function(e){var t=o[e];if(t){var r=t.src;n.remove(t),delete o[e],delete a[r]}}}),e.scripter=i}),e("skylark-utils-js/js",["skylark-utils/skylark","skylark-utils/scripter"],function(e,t){return t}),e("skylark-utils-js/primitives/beautify-js",[],function(){function e(e,t){for(var n=0;n<t.length;n+=1)if(t[n]===e)return!0;return!1}function t(e){return e.replace(/^\s+|\s+$/g,"")}function n(e,t){"use strict";var n=new r(e,t);return n.beautify()}function r(n,r){"use strict";function i(e,t){var n=0;e&&(n=e.indentation_level,!U.just_added_newline()&&e.line_indent_level>n&&(n=e.line_indent_level));var r={mode:t,parent:e,last_text:e?e.last_text:"",last_word:e?e.last_word:"",declaration_statement:!1,declaration_assignment:!1,multiline_frame:!1,if_block:!1,else_block:!1,do_block:!1,do_while:!1,in_case_statement:!1,in_case:!1,case_body:!1,indentation_level:n,line_indent_level:e?e.line_indent_level:n,start_line_index:U.get_line_number(),ternary_depth:0};return r}function o(e){var t=e.newlines,n=ee.keep_array_indentation&&g(Q.mode);if(n)for(r=0;r<t;r+=1)_(r>0);else if(ee.max_preserve_newlines&&t>ee.max_preserve_newlines&&(t=ee.max_preserve_newlines),ee.preserve_newlines&&e.newlines>1){_();for(var r=1;r<t;r+=1)_(!0)}$=e,Z[$.type]()}function u(e){e=e.replace(/\x0d/g,"");for(var t=[],n=e.indexOf("\n");n!==-1;)t.push(e.substring(0,n)),e=e.substring(n+1),n=e.indexOf("\n");return e.length&&t.push(e),t}function c(e){if(e=void 0!==e&&e,!U.just_added_newline())if(ee.preserve_newlines&&$.wanted_newline||e)_(!1,!0);else if(ee.wrap_line_length){var t=U.current_line.get_character_count()+$.text.length+(U.space_before_token?1:0);t>=ee.wrap_line_length&&_(!1,!0)}}function _(e,t){if(!t&&";"!==Q.last_text&&","!==Q.last_text&&"="!==Q.last_text&&"TK_OPERATOR"!==G)for(;Q.mode===l.Statement&&!Q.if_block&&!Q.do_block;)y();U.add_new_line(e)&&(Q.multiline_frame=!0)}function h(){U.just_added_newline()&&(ee.keep_array_indentation&&g(Q.mode)&&$.wanted_newline?(U.current_line.push($.whitespace_before),U.space_before_token=!1):U.set_indent(Q.indentation_level)&&(Q.line_indent_level=Q.indentation_level))}function f(e){e=e||$.text,h(),U.add_token(e)}function p(){Q.indentation_level+=1}function d(){Q.indentation_level>0&&(!Q.parent||Q.indentation_level>Q.parent.indentation_level)&&(Q.indentation_level-=1)}function m(e){Q?(J.push(Q),H=Q):H=i(null,e),Q=i(H,e)}function g(e){return e===l.ArrayLiteral}function v(t){return e(t,[l.Expression,l.ForInitializer,l.Conditional])}function y(){J.length>0&&(H=Q,Q=J.pop(),H.mode===l.Statement&&U.remove_redundant_indentation(H))}function E(){return Q.parent.mode===l.ObjectLiteral&&Q.mode===l.Statement&&(":"===Q.last_text&&0===Q.ternary_depth||"TK_RESERVED"===G&&e(Q.last_text,["get","set"]))}function T(){return!!("TK_RESERVED"===G&&e(Q.last_text,["var","let","const"])&&"TK_WORD"===$.type||"TK_RESERVED"===G&&"do"===Q.last_text||"TK_RESERVED"===G&&"return"===Q.last_text&&!$.wanted_newline||"TK_RESERVED"===G&&"else"===Q.last_text&&("TK_RESERVED"!==$.type||"if"!==$.text)||"TK_END_EXPR"===G&&(H.mode===l.ForInitializer||H.mode===l.Conditional)||"TK_WORD"===G&&Q.mode===l.BlockStatement&&!Q.in_case&&"--"!==$.text&&"++"!==$.text&&"TK_WORD"!==$.type&&"TK_RESERVED"!==$.type||Q.mode===l.ObjectLiteral&&(":"===Q.last_text&&0===Q.ternary_depth||"TK_RESERVED"===G&&e(Q.last_text,["get","set"])))&&(m(l.Statement),p(),"TK_RESERVED"===G&&e(Q.last_text,["var","let","const"])&&"TK_WORD"===$.type&&(Q.declaration_statement=!0),E()||c("TK_RESERVED"===$.type&&e($.text,["do","for","if","while"])),!0)}function b(e,n){for(var r=0;r<e.length;r++){var i=t(e[r]);if(i.charAt(0)!==n)return!1}return!0}function k(e,t){for(var n,r=0,i=e.length;r<i;r++)if(n=e[r],n&&0!==n.indexOf(t))return!1;return!0}function x(t){return e(t,["case","return","do","if","throw","else"])}function w(e){var t=W+(e||0);return t<0||t>=te.length?null:te[t]}function S(){T();var t=l.Expression;if("["===$.text){if("TK_WORD"===G||")"===Q.last_text)return"TK_RESERVED"===G&&e(Q.last_text,z.line_starters)&&(U.space_before_token=!0),m(t),f(),p(),void(ee.space_in_paren&&(U.space_before_token=!0));t=l.ArrayLiteral,g(Q.mode)&&("["!==Q.last_text&&(","!==Q.last_text||"]"!==X&&"}"!==X)||ee.keep_array_indentation||_())}else"TK_RESERVED"===G&&"for"===Q.last_text?t=l.ForInitializer:"TK_RESERVED"===G&&e(Q.last_text,["if","while"])&&(t=l.Conditional);";"===Q.last_text||"TK_START_BLOCK"===G?_():"TK_END_EXPR"===G||"TK_START_EXPR"===G||"TK_END_BLOCK"===G||"."===Q.last_text?c($.wanted_newline):"TK_RESERVED"===G&&"("===$.text||"TK_WORD"===G||"TK_OPERATOR"===G?"TK_RESERVED"===G&&("function"===Q.last_word||"typeof"===Q.last_word)||"*"===Q.last_text&&"function"===X?ee.space_after_anon_function&&(U.space_before_token=!0):"TK_RESERVED"!==G||!e(Q.last_text,z.line_starters)&&"catch"!==Q.last_text||ee.space_before_conditional&&(U.space_before_token=!0):U.space_before_token=!0,"("===$.text&&("TK_EQUALS"!==G&&"TK_OPERATOR"!==G||E()||c()),m(t),f(),ee.space_in_paren&&(U.space_before_token=!0),p()}function R(){for(;Q.mode===l.Statement;)y();Q.multiline_frame&&c("]"===$.text&&g(Q.mode)&&!ee.keep_array_indentation),ee.space_in_paren&&("TK_START_EXPR"!==G||ee.space_in_empty_paren?U.space_before_token=!0:(U.trim(),U.space_before_token=!1)),"]"===$.text&&ee.keep_array_indentation?(f(),y()):(y(),f()),U.remove_redundant_indentation(H),Q.do_while&&H.mode===l.Conditional&&(H.mode=l.Expression,Q.do_block=!1,Q.do_while=!1)}function K(){var t=w(1),n=w(2);m(n&&(":"===n.text&&e(t.type,["TK_STRING","TK_WORD","TK_RESERVED"])||e(t.text,["get","set"])&&e(n.type,["TK_WORD","TK_RESERVED"]))?e(X,["class","interface"])?l.BlockStatement:l.ObjectLiteral:l.BlockStatement);var r=!t.comments_before.length&&"}"===t.text,i=r&&"function"===Q.last_word&&"TK_END_EXPR"===G;"expand"===ee.brace_style||"none"===ee.brace_style&&$.wanted_newline?"TK_OPERATOR"!==G&&(i||"TK_EQUALS"===G||"TK_RESERVED"===G&&x(Q.last_text)&&"else"!==Q.last_text)?U.space_before_token=!0:_(!1,!0):"TK_OPERATOR"!==G&&"TK_START_EXPR"!==G?"TK_START_BLOCK"===G?_():U.space_before_token=!0:g(H.mode)&&","===Q.last_text&&("}"===X?U.space_before_token=!0:_()),f(),p()}function A(){for(;Q.mode===l.Statement;)y();var e="TK_START_BLOCK"===G;"expand"===ee.brace_style?e||_():e||(g(Q.mode)&&ee.keep_array_indentation?(ee.keep_array_indentation=!1,_(),ee.keep_array_indentation=!0):_()),y(),f()}function C(){if("TK_RESERVED"===$.type&&Q.mode!==l.ObjectLiteral&&e($.text,["set","get"])&&($.type="TK_WORD"),"TK_RESERVED"===$.type&&Q.mode===l.ObjectLiteral){var t=w(1);":"==t.text&&($.type="TK_WORD")}if(T()||!$.wanted_newline||v(Q.mode)||"TK_OPERATOR"===G&&"--"!==Q.last_text&&"++"!==Q.last_text||"TK_EQUALS"===G||!ee.preserve_newlines&&"TK_RESERVED"===G&&e(Q.last_text,["var","let","const","set","get"])||_(),Q.do_block&&!Q.do_while){if("TK_RESERVED"===$.type&&"while"===$.text)return U.space_before_token=!0,f(),U.space_before_token=!0,void(Q.do_while=!0);_(),Q.do_block=!1}if(Q.if_block)if(Q.else_block||"TK_RESERVED"!==$.type||"else"!==$.text){for(;Q.mode===l.Statement;)y();Q.if_block=!1,Q.else_block=!1}else Q.else_block=!0;if("TK_RESERVED"===$.type&&("case"===$.text||"default"===$.text&&Q.in_case_statement))return _(),(Q.case_body||ee.jslint_happy)&&(d(),Q.case_body=!1),f(),Q.in_case=!0,void(Q.in_case_statement=!0);if("TK_RESERVED"===$.type&&"function"===$.text&&((e(Q.last_text,["}",";"])||U.just_added_newline()&&!e(Q.last_text,["[","{",":","=",","]))&&(U.just_added_blankline()||$.comments_before.length||(_(),
_(!0))),"TK_RESERVED"===G||"TK_WORD"===G?"TK_RESERVED"===G&&e(Q.last_text,["get","set","new","return","export"])?U.space_before_token=!0:"TK_RESERVED"===G&&"default"===Q.last_text&&"export"===X?U.space_before_token=!0:_():"TK_OPERATOR"===G||"="===Q.last_text?U.space_before_token=!0:(Q.multiline_frame||!v(Q.mode)&&!g(Q.mode))&&_()),"TK_COMMA"!==G&&"TK_START_EXPR"!==G&&"TK_EQUALS"!==G&&"TK_OPERATOR"!==G||E()||c(),"TK_RESERVED"===$.type&&e($.text,["function","get","set"]))return f(),void(Q.last_word=$.text);if(Y="NONE","TK_END_BLOCK"===G?"TK_RESERVED"===$.type&&e($.text,["else","catch","finally"])?"expand"===ee.brace_style||"end-expand"===ee.brace_style||"none"===ee.brace_style&&$.wanted_newline?Y="NEWLINE":(Y="SPACE",U.space_before_token=!0):Y="NEWLINE":"TK_SEMICOLON"===G&&Q.mode===l.BlockStatement?Y="NEWLINE":"TK_SEMICOLON"===G&&v(Q.mode)?Y="SPACE":"TK_STRING"===G?Y="NEWLINE":"TK_RESERVED"===G||"TK_WORD"===G||"*"===Q.last_text&&"function"===X?Y="SPACE":"TK_START_BLOCK"===G?Y="NEWLINE":"TK_END_EXPR"===G&&(U.space_before_token=!0,Y="NEWLINE"),"TK_RESERVED"===$.type&&e($.text,z.line_starters)&&")"!==Q.last_text&&(Y="else"===Q.last_text||"export"===Q.last_text?"SPACE":"NEWLINE"),"TK_RESERVED"===$.type&&e($.text,["else","catch","finally"]))if("TK_END_BLOCK"!==G||"expand"===ee.brace_style||"end-expand"===ee.brace_style||"none"===ee.brace_style&&$.wanted_newline)_();else{U.trim(!0);var n=U.current_line;"}"!==n.last()&&_(),U.space_before_token=!0}else"NEWLINE"===Y?"TK_RESERVED"===G&&x(Q.last_text)?U.space_before_token=!0:"TK_END_EXPR"!==G?"TK_START_EXPR"===G&&"TK_RESERVED"===$.type&&e($.text,["var","let","const"])||":"===Q.last_text||("TK_RESERVED"===$.type&&"if"===$.text&&"else"===Q.last_text?U.space_before_token=!0:_()):"TK_RESERVED"===$.type&&e($.text,z.line_starters)&&")"!==Q.last_text&&_():Q.multiline_frame&&g(Q.mode)&&","===Q.last_text&&"}"===X?_():"SPACE"===Y&&(U.space_before_token=!0);f(),Q.last_word=$.text,"TK_RESERVED"===$.type&&"do"===$.text&&(Q.do_block=!0),"TK_RESERVED"===$.type&&"if"===$.text&&(Q.if_block=!0)}function N(){for(T()&&(U.space_before_token=!1);Q.mode===l.Statement&&!Q.if_block&&!Q.do_block;)y();f()}function O(){T()?U.space_before_token=!0:"TK_RESERVED"===G||"TK_WORD"===G?U.space_before_token=!0:"TK_COMMA"===G||"TK_START_EXPR"===G||"TK_EQUALS"===G||"TK_OPERATOR"===G?E()||c():_(),f()}function L(){T(),Q.declaration_statement&&(Q.declaration_assignment=!0),U.space_before_token=!0,f(),U.space_before_token=!0}function D(){return Q.declaration_statement?(v(Q.parent.mode)&&(Q.declaration_assignment=!1),f(),void(Q.declaration_assignment?(Q.declaration_assignment=!1,_(!1,!0)):U.space_before_token=!0)):(f(),void(Q.mode===l.ObjectLiteral||Q.mode===l.Statement&&Q.parent.mode===l.ObjectLiteral?(Q.mode===l.Statement&&y(),_()):U.space_before_token=!0))}function P(){if(T(),"TK_RESERVED"===G&&x(Q.last_text))return U.space_before_token=!0,void f();if("*"===$.text&&"TK_DOT"===G)return void f();if(":"===$.text&&Q.in_case)return Q.case_body=!0,p(),f(),_(),void(Q.in_case=!1);if("::"===$.text)return void f();!$.wanted_newline||"--"!==$.text&&"++"!==$.text||_(!1,!0),"TK_OPERATOR"===G&&c();var t=!0,n=!0;e($.text,["--","++","!","~"])||e($.text,["-","+"])&&(e(G,["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"])||e(Q.last_text,z.line_starters)||","===Q.last_text)?(t=!1,n=!1,";"===Q.last_text&&v(Q.mode)&&(t=!0),"TK_RESERVED"===G||"TK_END_EXPR"===G?t=!0:"TK_OPERATOR"===G&&(t=e($.text,["--","-"])&&e(Q.last_text,["--","-"])||e($.text,["++","+"])&&e(Q.last_text,["++","+"])),Q.mode!==l.BlockStatement&&Q.mode!==l.Statement||"{"!==Q.last_text&&";"!==Q.last_text||_()):":"===$.text?0===Q.ternary_depth?t=!1:Q.ternary_depth-=1:"?"===$.text?Q.ternary_depth+=1:"*"===$.text&&"TK_RESERVED"===G&&"function"===Q.last_text&&(t=!1,n=!1),U.space_before_token=U.space_before_token||t,f(),U.space_before_token=n}function I(){var e,n=u($.text),r=!1,i=!1,s=$.whitespace_before,a=s.length;for(_(!1,!0),n.length>1&&(b(n.slice(1),"*")?r=!0:k(n.slice(1),s)&&(i=!0)),f(n[0]),e=1;e<n.length;e++)_(!1,!0),r?f(" "+t(n[e])):i&&n[e].length>a?f(n[e].substring(a)):U.add_token(n[e]);_(!1,!0)}function V(){U.space_before_token=!0,f(),U.space_before_token=!0}function j(){$.wanted_newline?_(!1,!0):U.trim(!0),U.space_before_token=!0,f(),_(!1,!0)}function M(){T(),"TK_RESERVED"===G&&x(Q.last_text)?U.space_before_token=!0:c(")"===Q.last_text&&ee.break_chained_methods),f()}function F(){f(),"\n"===$.text[$.text.length-1]&&_()}function B(){for(;Q.mode===l.Statement;)y()}var U,W,z,$,G,X,q,Q,H,J,Y,Z,ee,te=[],ne="";for(Z={TK_START_EXPR:S,TK_END_EXPR:R,TK_START_BLOCK:K,TK_END_BLOCK:A,TK_WORD:C,TK_RESERVED:C,TK_SEMICOLON:N,TK_STRING:O,TK_EQUALS:L,TK_OPERATOR:P,TK_COMMA:D,TK_BLOCK_COMMENT:I,TK_INLINE_COMMENT:V,TK_COMMENT:j,TK_DOT:M,TK_UNKNOWN:F,TK_EOF:B},r=r?r:{},ee={},void 0!==r.braces_on_own_line&&(ee.brace_style=r.braces_on_own_line?"expand":"collapse"),ee.brace_style=r.brace_style?r.brace_style:ee.brace_style?ee.brace_style:"collapse","expand-strict"===ee.brace_style&&(ee.brace_style="expand"),ee.indent_size=r.indent_size?parseInt(r.indent_size,10):4,ee.indent_char=r.indent_char?r.indent_char:" ",ee.preserve_newlines=void 0===r.preserve_newlines||r.preserve_newlines,ee.break_chained_methods=void 0!==r.break_chained_methods&&r.break_chained_methods,ee.max_preserve_newlines=void 0===r.max_preserve_newlines?0:parseInt(r.max_preserve_newlines,10),ee.space_in_paren=void 0!==r.space_in_paren&&r.space_in_paren,ee.space_in_empty_paren=void 0!==r.space_in_empty_paren&&r.space_in_empty_paren,ee.jslint_happy=void 0!==r.jslint_happy&&r.jslint_happy,ee.space_after_anon_function=void 0!==r.space_after_anon_function&&r.space_after_anon_function,ee.keep_array_indentation=void 0!==r.keep_array_indentation&&r.keep_array_indentation,ee.space_before_conditional=void 0===r.space_before_conditional||r.space_before_conditional,ee.unescape_strings=void 0!==r.unescape_strings&&r.unescape_strings,ee.wrap_line_length=void 0===r.wrap_line_length?0:parseInt(r.wrap_line_length,10),ee.e4x=void 0!==r.e4x&&r.e4x,ee.end_with_newline=void 0!==r.end_with_newline&&r.end_with_newline,ee.jslint_happy&&(ee.space_after_anon_function=!0),r.indent_with_tabs&&(ee.indent_char="\t",ee.indent_size=1),q="";ee.indent_size>0;)q+=ee.indent_char,ee.indent_size-=1;var re=0;if(n&&n.length){for(;" "===n.charAt(re)||"\t"===n.charAt(re);)ne+=n.charAt(re),re+=1;n=n.substring(re)}G="TK_START_BLOCK",X="",U=new s(q,ne),J=[],m(l.BlockStatement),this.beautify=function(){var e,t;for(z=new a(n,ee,q),te=z.tokenize(),W=0;e=w();){for(var r=0;r<e.comments_before.length;r++)o(e.comments_before[r]);o(e),X=Q.last_text,G=e.type,Q.last_text=e.text,W+=1}return t=U.get_code(),ee.end_with_newline&&(t+="\n"),t}}function i(e){var t=0,n=-1,r=[],i=!0;this.set_indent=function(r){t=e.baseIndentLength+r*e.indent_length,n=r},this.get_character_count=function(){return t},this.is_empty=function(){return i},this.last=function(){return this._empty?null:r[r.length-1]},this.push=function(e){r.push(e),t+=e.length,i=!1},this.remove_indent=function(){n>0&&(n-=1,t-=e.indent_length)},this.trim=function(){for(;" "===this.last();){r.pop();t-=1}i=0===r.length},this.toString=function(){var t="";return this._empty||(n>=0&&(t=e.indent_cache[n]),t+=r.join("")),t}}function s(e,t){t=t||"",this.indent_cache=[t],this.baseIndentLength=t.length,this.indent_length=e.length;var n=[];this.baseIndentString=t,this.indent_string=e,this.current_line=null,this.space_before_token=!1,this.get_line_number=function(){return n.length},this.add_new_line=function(e){return(1!==this.get_line_number()||!this.just_added_newline())&&(!(!e&&this.just_added_newline())&&(this.current_line=new i(this),n.push(this.current_line),!0))},this.add_new_line(!0),this.get_code=function(){var e=n.join("\n").replace(/[\r\n\t ]+$/,"");return e},this.set_indent=function(e){if(n.length>1){for(;e>=this.indent_cache.length;)this.indent_cache.push(this.indent_cache[this.indent_cache.length-1]+this.indent_string);return this.current_line.set_indent(e),!0}return this.current_line.set_indent(0),!1},this.add_token=function(e){this.add_space_before_token(),this.current_line.push(e)},this.add_space_before_token=function(){this.space_before_token&&!this.just_added_newline()&&this.current_line.push(" "),this.space_before_token=!1},this.remove_redundant_indentation=function(e){if(!e.multiline_frame&&e.mode!==l.ForInitializer&&e.mode!==l.Conditional)for(var t=e.start_line_index,r=n.length;t<r;)n[t].remove_indent(),t++},this.trim=function(r){for(r=void 0!==r&&r,this.current_line.trim(e,t);r&&n.length>1&&this.current_line.is_empty();)n.pop(),this.current_line=n[n.length-1],this.current_line.trim()},this.just_added_newline=function(){return this.current_line.is_empty()},this.just_added_blankline=function(){if(this.just_added_newline()){if(1===n.length)return!0;var e=n[n.length-2];return e.is_empty()}return!1}}function a(n,r,i){function s(){var s,y=[];if(h=0,f="",m>=g)return["","TK_EOF"];var E;E=d.length?d[d.length-1]:new u("TK_START_BLOCK","{");var T=n.charAt(m);for(m+=1;e(T,l);){if("\n"===T?(h+=1,y=[]):h&&(T===i?y.push(i):"\r"!==T&&y.push(" ")),m>=g)return["","TK_EOF"];T=n.charAt(m),m+=1}if(y.length&&(f=y.join("")),c.test(T)){var b=!0,k=!0,x=c;for("0"===T&&m<g&&/[Xx]/.test(n.charAt(m))?(b=!1,k=!1,T+=n.charAt(m),m+=1,x=/[0123456789abcdefABCDEF]/):(T="",m-=1);m<g&&x.test(n.charAt(m));)T+=n.charAt(m),m+=1,b&&m<g&&"."===n.charAt(m)&&(T+=n.charAt(m),m+=1,b=!1),k&&m<g&&/[Ee]/.test(n.charAt(m))&&(T+=n.charAt(m),m+=1,m<g&&/[+-]/.test(n.charAt(m))&&(T+=n.charAt(m),m+=1),k=!1,b=!1);return[T,"TK_WORD"]}if(o.isIdentifierStart(n.charCodeAt(m-1))){if(m<g)for(;o.isIdentifierChar(n.charCodeAt(m))&&(T+=n.charAt(m),m+=1,m!==g););return"TK_DOT"===E.type||"TK_RESERVED"===E.type&&e(E.text,["set","get"])||!e(T,v)?[T,"TK_WORD"]:"in"===T?[T,"TK_OPERATOR"]:[T,"TK_RESERVED"]}if("("===T||"["===T)return[T,"TK_START_EXPR"];if(")"===T||"]"===T)return[T,"TK_END_EXPR"];if("{"===T)return[T,"TK_START_BLOCK"];if("}"===T)return[T,"TK_END_BLOCK"];if(";"===T)return[T,"TK_SEMICOLON"];if("/"===T){var w="",S=!0;if("*"===n.charAt(m)){if(m+=1,m<g)for(;m<g&&("*"!==n.charAt(m)||!n.charAt(m+1)||"/"!==n.charAt(m+1))&&(T=n.charAt(m),w+=T,"\n"!==T&&"\r"!==T||(S=!1),m+=1,!(m>=g)););return m+=2,S&&0===h?["/*"+w+"*/","TK_INLINE_COMMENT"]:["/*"+w+"*/","TK_BLOCK_COMMENT"]}if("/"===n.charAt(m)){for(w=T;"\r"!==n.charAt(m)&&"\n"!==n.charAt(m)&&(w+=n.charAt(m),m+=1,!(m>=g)););return[w,"TK_COMMENT"]}}if("`"===T||"'"===T||'"'===T||("/"===T||r.e4x&&"<"===T&&n.slice(m-1).match(/^<([-a-zA-Z:0-9_.]+|{[^{}]*}|!\[CDATA\[[\s\S]*?\]\])\s*([-a-zA-Z:0-9_.]+=('[^']*'|"[^"]*"|{[^{}]*})\s*)*\/?\s*>/))&&("TK_RESERVED"===E.type&&e(E.text,["return","case","throw","else","do","typeof","yield"])||"TK_END_EXPR"===E.type&&")"===E.text&&E.parent&&"TK_RESERVED"===E.parent.type&&e(E.parent.text,["if","while","for"])||e(E.type,["TK_COMMENT","TK_START_EXPR","TK_START_BLOCK","TK_END_BLOCK","TK_OPERATOR","TK_EQUALS","TK_EOF","TK_SEMICOLON","TK_COMMA"]))){var R=T,K=!1,A=!1;if(s=T,"/"===R)for(var C=!1;m<g&&(K||C||n.charAt(m)!==R)&&!o.newline.test(n.charAt(m));)s+=n.charAt(m),K?K=!1:(K="\\"===n.charAt(m),"["===n.charAt(m)?C=!0:"]"===n.charAt(m)&&(C=!1)),m+=1;else if(r.e4x&&"<"===R){var N=/<(\/?)([-a-zA-Z:0-9_.]+|{[^{}]*}|!\[CDATA\[[\s\S]*?\]\])\s*([-a-zA-Z:0-9_.]+=('[^']*'|"[^"]*"|{[^{}]*})\s*)*(\/?)\s*>/g,O=n.slice(m-1),L=N.exec(O);if(L&&0===L.index){for(var D=L[2],P=0;L;){var I=!!L[1],V=L[2],j=!!L[L.length-1]||"![CDATA["===V.slice(0,8);if(V!==D||j||(I?--P:++P),P<=0)break;L=N.exec(O)}var M=L?L.index+L[0].length:O.length;return m+=M-1,[O.slice(0,M),"TK_STRING"]}}else for(;m<g&&(K||n.charAt(m)!==R&&("`"===R||!o.newline.test(n.charAt(m))));)s+=n.charAt(m),K?("x"!==n.charAt(m)&&"u"!==n.charAt(m)||(A=!0),K=!1):K="\\"===n.charAt(m),m+=1;if(A&&r.unescape_strings&&(s=a(s)),m<g&&n.charAt(m)===R&&(s+=R,m+=1,"/"===R))for(;m<g&&o.isIdentifierStart(n.charCodeAt(m));)s+=n.charAt(m),m+=1;return[s,"TK_STRING"]}if("#"===T){if(0===d.length&&"!"===n.charAt(m)){for(s=T;m<g&&"\n"!==T;)T=n.charAt(m),s+=T,m+=1;return[t(s)+"\n","TK_UNKNOWN"]}var F="#";if(m<g&&c.test(n.charAt(m))){do T=n.charAt(m),F+=T,m+=1;while(m<g&&"#"!==T&&"="!==T);return"#"===T||("["===n.charAt(m)&&"]"===n.charAt(m+1)?(F+="[]",m+=2):"{"===n.charAt(m)&&"}"===n.charAt(m+1)&&(F+="{}",m+=2)),[F,"TK_WORD"]}}if("<"===T&&"<!--"===n.substring(m-1,m+3)){for(m+=3,T="<!--";"\n"!==n.charAt(m)&&m<g;)T+=n.charAt(m),m++;return p=!0,[T,"TK_COMMENT"]}if("-"===T&&p&&"-->"===n.substring(m-1,m+2))return p=!1,m+=2,["-->","TK_COMMENT"];if("."===T)return[T,"TK_DOT"];if(e(T,_)){for(;m<g&&e(T+n.charAt(m),_)&&(T+=n.charAt(m),m+=1,!(m>=g)););return","===T?[T,"TK_COMMA"]:"="===T?[T,"TK_EQUALS"]:[T,"TK_OPERATOR"]}return[T,"TK_UNKNOWN"]}function a(e){for(var t,n=!1,r="",i=0,s="",a=0;n||i<e.length;)if(t=e.charAt(i),i++,n){if(n=!1,"x"===t)s=e.substr(i,2),i+=2;else{if("u"!==t){r+="\\"+t;continue}s=e.substr(i,4),i+=4}if(!s.match(/^[0123456789abcdefABCDEF]+$/))return e;if(a=parseInt(s,16),a>=0&&a<32){r+="x"===t?"\\x"+s:"\\u"+s;continue}if(34===a||39===a||92===a)r+="\\"+String.fromCharCode(a);else{if("x"===t&&a>126&&a<=255)return e;r+=String.fromCharCode(a)}}else"\\"===t?n=!0:r+=t;return r}var l="\n\r\t ".split(""),c=/[0-9]/,_="+ - * / % & ++ -- = += -= *= /= %= == === != !== > < >= <= >> << >>> >>>= >>= <<= && &= | || ! ~ , : ? ^ ^= |= :: => <%= <% %> <?= <? ?>".split(" ");this.line_starters="continue,try,throw,return,var,let,const,if,switch,case,default,for,while,break,function,yield,import,export".split(",");var h,f,p,d,m,g,v=this.line_starters.concat(["do","in","else","get","set","new","catch","finally","typeof"]);this.tokenize=function(){g=n.length,m=0,p=!1,d=[];for(var e,t,r,i=null,a=[],o=[];!t||"TK_EOF"!==t.type;){for(r=s(),e=new u(r[1],r[0],h,f);"TK_INLINE_COMMENT"===e.type||"TK_COMMENT"===e.type||"TK_BLOCK_COMMENT"===e.type||"TK_UNKNOWN"===e.type;)o.push(e),r=s(),e=new u(r[1],r[0],h,f);o.length&&(e.comments_before=o,o=[]),"TK_START_BLOCK"===e.type||"TK_START_EXPR"===e.type?(e.parent=t,i=e,a.push(e)):("TK_END_BLOCK"===e.type||"TK_END_EXPR"===e.type)&&i&&("]"===e.text&&"["===i.text||")"===e.text&&"("===i.text||"}"===e.text&&"}"===i.text)&&(e.parent=i.parent,i=a.pop()),d.push(e),t=e}return d}}var o={};!function(e){var t="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",n="̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿",r=new RegExp("["+t+"]"),i=new RegExp("["+t+n+"]");e.newline=/[\n\r\u2028\u2029]/,e.isIdentifierStart=function(e){return e<65?36===e:e<91||(e<97?95===e:e<123||e>=170&&r.test(String.fromCharCode(e)))},e.isIdentifierChar=function(e){return e<48?36===e:e<58||!(e<65)&&(e<91||(e<97?95===e:e<123||e>=170&&i.test(String.fromCharCode(e))))}}(o);var l={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",ForInitializer:"ForInitializer",Conditional:"Conditional",Expression:"Expression"},u=function(e,t,n,r,i,s){this.type=e,this.text=t,this.comments_before=[],this.newlines=n||0,this.wanted_newline=n>0,this.whitespace_before=r||"",this.parent=null};return{js_beautify:n}}),e("skylark-utils-js/beautify",["./js","./primitives/beautify-js"],function(e,t){return e.beautify=t.js_beautify}),e("skylark-utils-html/primitives/beautify-html",["skylark-utils-css/beautify","skylark-utils-js/beautify"],function(e,t){function n(e){return e.replace(/^\s+/g,"")}function r(e){return e.replace(/\s+$/g,"")}function i(e,t,i,s){function a(){return this.pos=0,this.token="",this.current_mode="CONTENT",this.tags={parent:"parent1",parentcount:1,parent1:""},this.tag_type="",this.token_text=this.last_token=this.last_text=this.token_type="",this.newlines=0,this.indent_content=l,this.Utils={whitespace:"\n\r\t ".split(""),single_token:"br,input,link,meta,!doctype,basefont,base,area,hr,wbr,param,img,isindex,?xml,embed,?php,?,?=".split(","),extra_liners:"head,body,/html".split(","),in_array:function(e,t){for(var n=0;n<t.length;n++)if(e===t[n])return!0;return!1}},this.is_whitespace=function(e){for(var t=0;t<e.length;e++)if(!this.Utils.in_array(e.charAt(t),this.Utils.whitespace))return!1;return!0},this.traverse_whitespace=function(){var e="";if(e=this.input.charAt(this.pos),this.Utils.in_array(e,this.Utils.whitespace)){for(this.newlines=0;this.Utils.in_array(e,this.Utils.whitespace);)p&&"\n"===e&&this.newlines<=d&&(this.newlines+=1),this.pos++,e=this.input.charAt(this.pos);return!0}return!1},this.space_or_wrap=function(e){this.line_char_count>=this.wrap_line_length?(this.print_newline(!1,e),this.print_indentation(e)):(this.line_char_count++,e.push(" "))},this.get_content=function(){for(var e="",t=[];"<"!==this.input.charAt(this.pos);){if(this.pos>=this.input.length)return t.length?t.join(""):["","TK_EOF"];if(this.traverse_whitespace())this.space_or_wrap(t);else{if(m){var n=this.input.substr(this.pos,3);if("{{#"===n||"{{/"===n)break;if("{{"===this.input.substr(this.pos,2)&&"{{else}}"===this.get_tag(!0))break}e=this.input.charAt(this.pos),this.pos++,this.line_char_count++,t.push(e)}}return t.length?t.join(""):""},this.get_contents_to=function(e){if(this.pos===this.input.length)return["","TK_EOF"];var t="",n=new RegExp("</"+e+"\\s*>","igm");n.lastIndex=this.pos;var r=n.exec(this.input),i=r?r.index:this.input.length;return this.pos<i&&(t=this.input.substring(this.pos,i),this.pos=i),t},this.record_tag=function(e){this.tags[e+"count"]?(this.tags[e+"count"]++,this.tags[e+this.tags[e+"count"]]=this.indent_level):(this.tags[e+"count"]=1,this.tags[e+this.tags[e+"count"]]=this.indent_level),this.tags[e+this.tags[e+"count"]+"parent"]=this.tags.parent,this.tags.parent=e+this.tags[e+"count"]},this.retrieve_tag=function(e){if(this.tags[e+"count"]){for(var t=this.tags.parent;t&&e+this.tags[e+"count"]!==t;)t=this.tags[t+"parent"];t&&(this.indent_level=this.tags[e+this.tags[e+"count"]],this.tags.parent=this.tags[t+"parent"]),delete this.tags[e+this.tags[e+"count"]+"parent"],delete this.tags[e+this.tags[e+"count"]],1===this.tags[e+"count"]?delete this.tags[e+"count"]:this.tags[e+"count"]--}},this.indent_to_tag=function(e){if(this.tags[e+"count"]){for(var t=this.tags.parent;t&&e+this.tags[e+"count"]!==t;)t=this.tags[t+"parent"];t&&(this.indent_level=this.tags[e+this.tags[e+"count"]])}},this.get_tag=function(e){var t,n,r,i="",s=[],a="",o=!1,l=this.pos,u=this.line_char_count;e=void 0!==e&&e;do{if(this.pos>=this.input.length)return e&&(this.pos=l,this.line_char_count=u),s.length?s.join(""):["","TK_EOF"];if(i=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(i,this.Utils.whitespace))o=!0;else{if("'"!==i&&'"'!==i||(i+=this.get_unformatted(i),o=!0),"="===i&&(o=!1),s.length&&"="!==s[s.length-1]&&">"!==i&&o&&(this.space_or_wrap(s),o=!1),m&&"<"===r&&i+this.input.charAt(this.pos)==="{{"&&(i+=this.get_unformatted("}}"),s.length&&" "!==s[s.length-1]&&"<"!==s[s.length-1]&&(i=" "+i),o=!0),"<"!==i||r||(t=this.pos-1,r="<"),m&&!r&&s.length>=2&&"{"===s[s.length-1]&&"{"==s[s.length-2]&&(t="#"===i||"/"===i?this.pos-3:this.pos-2,r="{"),this.line_char_count++,s.push(i),s[1]&&"!"===s[1]){s=[this.get_comment(t)];break}if(m&&"{"===r&&s.length>2&&"}"===s[s.length-2]&&"}"===s[s.length-1])break}}while(">"!==i);var c,_,h=s.join("");c=h.indexOf(" ")!==-1?h.indexOf(" "):"{"===h[0]?h.indexOf("}"):h.indexOf(">"),_="<"!==h[0]&&m?"#"===h[2]?3:2:1;var p=h.substring(_,c).toLowerCase();return"/"===h.charAt(h.length-2)||this.Utils.in_array(p,this.Utils.single_token)?e||(this.tag_type="SINGLE"):m&&"{"===h[0]&&"else"===p?e||(this.indent_to_tag("if"),this.tag_type="HANDLEBARS_ELSE",this.indent_content=!0,this.traverse_whitespace()):this.is_unformatted(p,f)?(a=this.get_unformatted("</"+p+">",h),s.push(a),n=this.pos-1,this.tag_type="SINGLE"):"script"===p&&(h.search("type")===-1||h.search("type")>-1&&h.search(/\b(text|application)\/(x-)?(javascript|ecmascript|jscript|livescript)/)>-1)?e||(this.record_tag(p),this.tag_type="SCRIPT"):"style"===p&&(h.search("type")===-1||h.search("type")>-1&&h.search("text/css")>-1)?e||(this.record_tag(p),this.tag_type="STYLE"):"!"===p.charAt(0)?e||(this.tag_type="SINGLE",this.traverse_whitespace()):e||("/"===p.charAt(0)?(this.retrieve_tag(p.substring(1)),this.tag_type="END"):(this.record_tag(p),"html"!==p.toLowerCase()&&(this.indent_content=!0),this.tag_type="START"),this.traverse_whitespace()&&this.space_or_wrap(s),this.Utils.in_array(p,this.Utils.extra_liners)&&(this.print_newline(!1,this.output),this.output.length&&"\n"!==this.output[this.output.length-2]&&this.print_newline(!0,this.output))),e&&(this.pos=l,this.line_char_count=u),s.join("")},this.get_comment=function(e){var t="",n=">",r=!1;for(this.pos=e,input_char=this.input.charAt(this.pos),this.pos++;this.pos<=this.input.length&&(t+=input_char,t[t.length-1]!==n[n.length-1]||t.indexOf(n)===-1);)!r&&t.length<10&&(0===t.indexOf("<![if")?(n="<![endif]>",r=!0):0===t.indexOf("<![cdata[")?(n="]]>",r=!0):0===t.indexOf("<![")?(n="]>",r=!0):0===t.indexOf("<!--")&&(n="-->",r=!0)),input_char=this.input.charAt(this.pos),this.pos++;return t},this.get_unformatted=function(e,t){if(t&&t.toLowerCase().indexOf(e)!==-1)return"";var n="",r="",i=0,s=!0;do{if(this.pos>=this.input.length)return r;if(n=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(n,this.Utils.whitespace)){if(!s){this.line_char_count--;continue}if("\n"===n||"\r"===n){r+="\n",this.line_char_count=0;continue}}r+=n,this.line_char_count++,s=!0,m&&"{"===n&&r.length&&"{"===r[r.length-2]&&(r+=this.get_unformatted("}}"),i=r.length)}while(r.toLowerCase().indexOf(e,i)===-1);return r},this.get_token=function(){var e;if("TK_TAG_SCRIPT"===this.last_token||"TK_TAG_STYLE"===this.last_token){var t=this.last_token.substr(7);return e=this.get_contents_to(t),"string"!=typeof e?e:[e,"TK_"+t]}if("CONTENT"===this.current_mode)return e=this.get_content(),"string"!=typeof e?e:[e,"TK_CONTENT"];if("TAG"===this.current_mode){if(e=this.get_tag(),"string"!=typeof e)return e;var n="TK_TAG_"+this.tag_type;return[e,n]}},this.get_full_indent=function(e){return e=this.indent_level+e||0,e<1?"":Array(e+1).join(this.indent_string)},this.is_unformatted=function(e,t){if(!this.Utils.in_array(e,t))return!1;if("a"!==e.toLowerCase()||!this.Utils.in_array("a",t))return!0;var n=this.get_tag(!0),r=(n||"").match(/^\s*<\s*\/?([a-z]*)\s*[^>]*>\s*$/);return!(r&&!this.Utils.in_array(r,t))},this.printer=function(e,t,i,s,a){this.input=e||"",this.output=[],this.indent_character=t,this.indent_string="",this.indent_size=i,this.brace_style=a,this.indent_level=0,this.wrap_line_length=s,this.line_char_count=0;for(var o=0;o<this.indent_size;o++)this.indent_string+=this.indent_character;this.print_newline=function(e,t){this.line_char_count=0,t&&t.length&&(e||"\n"!==t[t.length-1])&&("\n"!==t[t.length-1]&&(t[t.length-1]=r(t[t.length-1])),t.push("\n"))},this.print_indentation=function(e){for(var t=0;t<this.indent_level;t++)e.push(this.indent_string),this.line_char_count+=this.indent_string.length},this.print_token=function(e){this.is_whitespace(e)&&!this.output.length||((e||""!==e)&&this.output.length&&"\n"===this.output[this.output.length-1]&&(this.print_indentation(this.output),e=n(e)),this.print_token_raw(e))},this.print_token_raw=function(e){this.newlines>0&&(e=r(e)),e&&""!==e&&(e.length>1&&"\n"===e[e.length-1]?(this.output.push(e.slice(0,-1)),this.print_newline(!1,this.output)):this.output.push(e));for(var t=0;t<this.newlines;t++)this.print_newline(t>0,this.output);this.newlines=0},this.indent=function(){this.indent_level++},this.unindent=function(){this.indent_level>0&&this.indent_level--}},this}var o,l,u,c,_,h,f,p,d,m,g;for(t=t||{},void 0!==t.wrap_line_length&&0!==parseInt(t.wrap_line_length,10)||void 0===t.max_char||0===parseInt(t.max_char,10)||(t.wrap_line_length=t.max_char),l=void 0!==t.indent_inner_html&&t.indent_inner_html,u=void 0===t.indent_size?4:parseInt(t.indent_size,10),c=void 0===t.indent_char?" ":t.indent_char,h=void 0===t.brace_style?"collapse":t.brace_style,_=0===parseInt(t.wrap_line_length,10)?32786:parseInt(t.wrap_line_length||250,10),f=t.unformatted||["a","span","img","bdo","em","strong","dfn","code","samp","kbd","var","cite","abbr","acronym","q","sub","sup","tt","i","b","big","small","u","s","strike","font","ins","del","pre","address","dt","h1","h2","h3","h4","h5","h6"],p=void 0===t.preserve_newlines||t.preserve_newlines,d=p?isNaN(parseInt(t.max_preserve_newlines,10))?32786:parseInt(t.max_preserve_newlines,10):0,m=void 0!==t.indent_handlebars&&t.indent_handlebars,g=void 0!==t.end_with_newline&&t.end_with_newline,o=new a,o.printer(e,c,u,_,h);;){var v=o.get_token();if(o.token_text=v[0],o.token_type=v[1],"TK_EOF"===o.token_type)break;switch(o.token_type){case"TK_TAG_START":o.print_newline(!1,o.output),o.print_token(o.token_text),o.indent_content&&(o.indent(),o.indent_content=!1),o.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":o.print_newline(!1,o.output),o.print_token(o.token_text),o.current_mode="CONTENT";break;case"TK_TAG_END":if("TK_CONTENT"===o.last_token&&""===o.last_text){var y=o.token_text.match(/\w+/)[0],E=null;o.output.length&&(E=o.output[o.output.length-1].match(/(?:<|{{#)\s*(\w+)/)),null!==E&&E[1]===y||o.print_newline(!1,o.output)}o.print_token(o.token_text),o.current_mode="CONTENT";break;case"TK_TAG_SINGLE":var T=o.token_text.match(/^\s*<([a-z-]+)/i);T&&o.Utils.in_array(T[1],f)||o.print_newline(!1,o.output),o.print_token(o.token_text),o.current_mode="CONTENT";break;case"TK_TAG_HANDLEBARS_ELSE":o.print_token(o.token_text),o.indent_content&&(o.indent(),o.indent_content=!1),o.current_mode="CONTENT";break;case"TK_CONTENT":o.print_token(o.token_text),o.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":if(""!==o.token_text){o.print_newline(!1,o.output);var b,k=o.token_text,x=1;"TK_SCRIPT"===o.token_type?b="function"==typeof i&&i:"TK_STYLE"===o.token_type&&(b="function"==typeof s&&s),"keep"===t.indent_scripts?x=0:"separate"===t.indent_scripts&&(x=-o.indent_level);var w=o.get_full_indent(x);if(b)k=b(k.replace(/^\s*/,w),t);else{var S=k.match(/^\s*/)[0],R=S.match(/[^\n\r]*$/)[0].split(o.indent_string).length-1,K=o.get_full_indent(x-R);k=k.replace(/^\s*/,w).replace(/\r\n|\r|\n/g,"\n"+K).replace(/\s+$/,"")}k&&(o.print_token_raw(k),o.print_newline(!0,o.output))}o.current_mode="TAG";break;default:""!==o.token_text&&o.print_token(o.token_text)}o.last_token=o.token_type,o.last_text=o.token_text}var A=o.output.join("").replace(/[\r\n\t ]+$/,"");return g&&(A+="\n"),A}return{html_beautify:function(t,n){return i(t,n,beautifyJs,e)}}}),e("skylark-utils-html/beautify",["./html","./primitives/beautify-html"],function(e,t){return e.beautify=t.html_beautify}),e("skylark-utils-html/main",["./html","./beautify"],function(e){return e}),e("skylark-utils-html",["skylark-utils-html/main"],function(e){return e})},this);
//# sourceMappingURL=sourcemaps/skylark-utils-html.js.map
